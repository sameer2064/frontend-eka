<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Eka Racing - 3 Lane Smooth Version</title>
<style>
  html, body {
    margin: 0; padding: 0; overflow: hidden; background: #111;
    font-family: 'Orbitron', sans-serif;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
  }
  #gameContainer {
    position: relative;
    width: 100vw; height: 100vh;
  }
  canvas {
    display: block;
  }
  #ui {
    position: absolute;
    top: 12px; left: 12px;
    color: #0ff;
    text-shadow: 0 0 6px #0ff;
    font-weight: 700;
    z-index: 10;
    user-select: none;
  }
  #ui > div {
    margin-bottom: 8px;
    font-size: 18px;
  }
  #gameOverScreen {
    position: absolute;
    top: 0; left: 0;
    width: 100vw; height: 100vh;
    background: rgba(0,0,0,0.85);
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    color: #f33;
    font-size: 48px;
    font-weight: 900;
    text-shadow: 0 0 12px #f33;
    z-index: 50;
  }
  #gameOverScreen button {
    margin-top: 24px;
    font-size: 24px;
    padding: 12px 24px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    background: linear-gradient(45deg,#f33,#a00);
    color: white;
    text-transform: uppercase;
    letter-spacing: 3px;
    box-shadow: 0 0 12px #f33;
  }
  #controls {
    position: absolute;
    bottom: 16px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 20px;
    z-index: 20;
  }
  .btn {
    width: 72px;
    height: 72px;
    border-radius: 50%;
    background: rgba(0,255,255,0.2);
    border: 2px solid #0ff;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 36px;
    color: #0ff;
    cursor: pointer;
    user-select: none;
    transition: background 0.3s;
  }
  .btn:active {
    background: rgba(0,255,255,0.5);
  }
</style>
</head>
<body>
<div id="gameContainer"></div>
<div id="ui">
  <div>Score: <span id="score">0</span></div>
  <div>Level: <span id="level">1</span></div>
  <div>Speed: <span id="speed">0</span> km/h</div>
</div>
<div id="gameOverScreen">
  GAME OVER
  <button id="restartBtn">Restart</button>
</div>
<div id="controls">
  <div class="btn" id="leftBtn">&#8592;</div>
  <div class="btn" id="rightBtn">&#8594;</div>
  <div class="btn" id="accelBtn">&#9650;</div>
  <div class="btn" id="brakeBtn">&#9660;</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/7.2.4/pixi.min.js"></script>
<script>
(() => {
  // CHANGES FOR 3 LANES AND SMOOTH TURNING
  const LANE_WIDTH = 140;
  const LANES = 3;
  const ROAD_WIDTH = LANE_WIDTH * LANES;
  const ROAD_LEFT = window.innerWidth / 2 - ROAD_WIDTH / 2;
  const ROAD_RIGHT = ROAD_LEFT + ROAD_WIDTH;
  const CAR_WIDTH = 80;
  const CAR_HEIGHT = 140;
  const SMOOTH_TURN_SPEED = 5;

  let playerLane = 1; // Start in middle lane
  let targetLane = 1;

  const app = new PIXI.Application({
    width: window.innerWidth,
    height: window.innerHeight,
    backgroundColor: 0x111111
  });
  document.getElementById("gameContainer").appendChild(app.view);

  const playerCar = new PIXI.Graphics();
  playerCar.beginFill(0x0044cc);
  playerCar.drawRoundedRect(-CAR_WIDTH / 2, -CAR_HEIGHT / 2, CAR_WIDTH, CAR_HEIGHT, 20);
  playerCar.endFill();
  playerCar.y = app.renderer.height - CAR_HEIGHT - 20;
  playerCar.x = ROAD_LEFT + LANE_WIDTH / 2 + LANE_WIDTH * playerLane;
  app.stage.addChild(playerCar);

  // Movement logic
  function updatePlayerPosition() {
    const targetX = ROAD_LEFT + LANE_WIDTH / 2 + targetLane * LANE_WIDTH;
    const dx = targetX - playerCar.x;
    playerCar.x += dx * 0.2; // Smooth easing
  }

  function moveLeft() {
    if (targetLane > 0) targetLane--;
  }

  function moveRight() {
    if (targetLane < LANES - 1) targetLane++;
  }

  document.getElementById("leftBtn").addEventListener("click", moveLeft);
  document.getElementById("rightBtn").addEventListener("click", moveRight);

  window.addEventListener("keydown", e => {
    if (e.key === "ArrowLeft") moveLeft();
    if (e.key === "ArrowRight") moveRight();
  });

  app.ticker.add(() => {
    updatePlayerPosition();
  });
})();
</script>
</body>
</html>
